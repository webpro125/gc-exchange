- content_for :header do
  = render 'layouts/registration_header'
.page-content
  %section
    %section.entity-company.taxonomy-view
      %header.ui-box.taxonomy-head{"data-section" => "toggle-head", "data-toggle-container" => ""}
        .entity-head{"data-ignore-global-close" => "1", "data-target" => "toggle-head", "data-type" => "cm-toggle"}
          %h1= @owned_company.company_name
          .ui-panel-toggle.icon-cr-plus-full
        .entity-info.grid.columns-3.ui-panel{"data-section" => "toggle-head", "data-slide-open" => ""}
          .grid-4-12
            %h3 Company Address
            %p 1 Infinite Loop
            %p Cupertino, California
          .grid-4-12
            %h3 Company Contract POC
            %p.name= @owned_company.owner.full_name.split.map(&:capitalize).join(' ')
            %p.email= @owned_company.owner.email
            %p= @owned_company.phone
          .grid-4-12
            %h3 Company Documents
            - if !@owned_company.contract_file_name.blank? && @owned_company.contract.file.exists?
              %ul.doc-list
                %li
                  %a{:href => ""} General Services Contract
                %li
                  %a{:href => ""} Contract Rider
      %section.taxonomy-units
        %section.row.unit-maximized.connect-rule-up
          %header.unit-head.invalid
            %form
              %input{:placeholder => "Concept Design", :type => "text", :value => "#{@account_manager.business_unit_name}"}/
          %section.ui-tabs
            %article.tab-panel.is-open
              .section-intro
                %h1.section-title Assign Unit Roles
                %p.section-description.grid-8-12
                  Add brief description here lorem ipsum sit amet quosque tandem set numa consect. Ipsum sit amet quosque tandem set numa consect. Click on the button below if you want to learn more about
                  %a{:href => "", :style => "color: #7a7a7a;"}
                    our systems automated workflows for
                    = succeed "." do
                      %strong.type-primaryk work authorizations
                  %br/
                  %a.type-primary.hidden{:href => ""} Learn More About Work Authorization Automated Workflow
                  %a.button-primary.small{:href => ""} Learn More
                %figure.figure-business-unit
                  = image_tag 'infographics_unit_role2.png'
              .grid.columns-3.unit-roles-grid
                .grid-4-12.unit-role.icon-profile2
                  %h2 Selection Authorities
                  %p Searches and selects consultants to work on projects, documents draft statement of work and other work agreement terms with consultant.
                  %a.button-cta.button-primary.small.modal-toggle{"data-type" => "cm-modal"} Assign Role
                .grid-4-12.unit-role.icon-profile2
                  %h2 Requisition Authority
                  %p Receives the draft SOW and preliminary terms from the Selection Authority. Then authors a Requisition to for Consultant to support the Client Company.
                  %a.button-cta.button-primary.small.modal-toggle{"data-type" => "cm-modal"} Assign Role
                .grid-4-12.unit-role.icon-profile2
                  %h2 Approval Authority
                  %p Approves the Statement of Work and other consulting terms resulting from the negotiation process, the issues PO authorizing work to start.
                  %a.button-cta.button-primary.small.modal-toggle{"data-type" => "cm-modal"} Assign Role

%section.ui-modal
  .modal-box
    %header
      %h1 Assign Selection Authority Role
    .modal-content
      .modal-scroller
        = simple_form_for @unit_role, method: :put,
          remote: true, html: { data: { modal: true, type: :json }, class: 'theme-gces', id: 'unit_role_form' },
          url: do_assign_business_role_account_managers_path do |f|
          = render 'shared/base_error', model: @unit_role
          %section.ui-card
            = f.input :email, required: false, placeholder: 'Email', label: false,
            :url => autocomplete_user_email_account_managers_path, :as => :autocomplete,
            wrapper: :custom_input, input_wrapper_html: { class: 'icon-email' }
            .grid.columns-2.margin-top-1r{:role => "grid"}
              .grid-6-12{:role => "gridcell"}
                = f.input :first_name, required: false, placeholder: 'First Name', label: false,
                  wrapper: :custom_input, input_wrapper_html: { class: 'icon-profile' }
              .grid-6-12{:role => "gridcell"}
                = f.input :last_name, required: false, placeholder: 'Last Name', label: false,
                  wrapper: :custom_input, input_wrapper_html: { class: 'icon-profile' }
            .section-block.user-permissions
              %h3 You can assign this person to one role or all of them
              %section.card-section
                .ui-checkbox.medium
                  = f.check_box :selection_authority, {id: 'selection-authority'}
                  %label{:for => "selection-authority"} Selection Authority
                .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
                  %div{"data-type" => "template-question-sample1b"}
                    %p Include explanation about this section here.
              %section.card-section
                .ui-checkbox.medium
                  = f.check_box :requisition_authority, {id: 'requisition-authority'}
                  %label{:for => "requisition-authority"} Requisition Authority
                .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
                  %div{"data-type" => "template-question-sample1b"}
                    %p Include explanation about this section here.
              %section.card-section
                .ui-checkbox.medium
                  = f.check_box :approval_authority, {id: 'approval-authority'}
                  %label{:for => "approval-authority"} Approval Authority
                .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
                  %div{"data-type" => "template-question-sample1b"}
                    %p Include explanation about this section here.
              %section.card-section
                = hidden_field_tag 'business_unit_role[authority_required]'
            = f.submit 'Add Unit Roles', class: 'button-primary button-cta'
    %footer
      .modal-close.ui-action-icon.icon-cr-cross-light



- content_for :footer do
  %footer#main-footer{:role => "contentinfo"}
    %p.site-credits &copy; 2015 Playground
  .ui-popover
- content_for :js do
  :javascript
    (function () {
        $(function () {
            var eventEmitter = $(document);

            eventEmitter.on('cm.toggle.close', function (event, data) {
                $('.entity-taxonomy').removeClass('is-open');
            });

            eventEmitter.on('cm.toggle.open', function (event, data) {
                if (data['toggle-head'] === undefined) {
                    $('.entity-taxonomy').addClass('is-open');
                }
            });
        });
    })();
