- content_for :header do
  = render 'layouts/registration_header'
.page-content
  %section
    %section.entity-company.taxonomy-view
      %header.ui-box.taxonomy-head{"data-section" => "toggle-head", "data-toggle-container" => ""}
        .entity-head{"data-ignore-global-close" => "1", "data-target" => "toggle-head", "data-type" => "cm-toggle"}
          %h1 Tesla Automobiles, Inc
          .ui-panel-toggle.icon-cr-plus-full
        .entity-info.grid.columns-3.ui-panel{"data-section" => "toggle-head", "data-slide-open" => ""}
          .grid-4-12
            %h3 Company Address
            %p 1 Infinite Loop
            %p Cupertino, California
          .grid-4-12
            %h3 Company Contract POC
            %p.name Frank Smith
            %p.email franksmithjunior@apple.com
            %p (954) 345 9876
          .grid-4-12
            %h3 Company Documents
            %ul.doc-list
              %li
                %a{:href => ""} General Services Contract
              %li
                %a{:href => ""} Contract Rider
    %section.taxonomy-units
      = simple_form_for(@unit_role, method: :put,
          url: do_assign_business_role_account_managers_path, html: {class: 'theme-gces'}) do |f|
        = render 'shared/base_error', model: @unit_role
        %section.ui-card.icon-profile2.profile
          = f.input :email, required: false, placeholder: 'Email', label: false,
            :url => autocomplete_user_email_account_managers_path, :as => :autocomplete,
            wrapper: :custom_input, input_wrapper_html: { class: 'icon-email' }
          .grid.columns-2.margin-top-1r{:role => "grid"}
            .grid-6-12{:role => "gridcell"}
              = f.input :first_name, required: false, placeholder: 'First Name', label: false,
                wrapper: :custom_input, input_wrapper_html: { class: 'icon-profile' }
            .grid-6-12{:role => "gridcell"}
              = f.input :last_name, required: false, placeholder: 'Last Name', label: false,
                wrapper: :custom_input, input_wrapper_html: { class: 'icon-profile' }
          %section.section-block.user-permissions
            %h3 Select One or More User Permissions
            %section.card-section
              .ui-checkbox.medium
                = f.check_box :selection_authority, {id: 'selection-authority'}
                %label{:for => "selection-authority"} Selection Authority
              .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
                %div{"data-type" => "template-question-sample1b"}
                  %p Include explanation about this section here.
            %section.card-section
              .ui-checkbox.medium
                = f.check_box :requisition_authority, {id: 'requisition-authority'}
                %label{:for => "requisition-authority"} Requisition Authority
              .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
                %div{"data-type" => "template-question-sample1b"}
                  %p Include explanation about this section here.
            %section.card-section
              .ui-checkbox.medium
                = f.check_box :approval_authority, {id: 'approval-authority'}
                %label{:for => "approval-authority"} Approval Authority
              .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
                %div{"data-type" => "template-question-sample1b"}
                  %p Include explanation about this section here.
          = button_tag 'Add User Business Roles', type: 'submit', class: "button-cta button-primary icon-cr-arrow-right"
  - @unit_roles.each_with_index do |unit_role, role_index|
    - next unless unit_role.persisted?
    %section.ui-card.icon-profile2.profile.is-collapsible.is-close
      %header.card-header
        %h2= unit_role.user.full_name
        %h3 Account Manager
        %p.type-intro
          = unit_role.account_manager.company.company_name
          = link_to '', '#', class: 'ui-action-link ui-edit icon-edit'
        %p.type-intro.type-blue.contact-email= unit_role.user.email
        %p.user-roles Requisition Authoriy
      = simple_form_for(unit_role, method: :put,
        url: account_manager_update_assign_business_role_path(unit_role), html: {class: 'theme-gces'}) do |f|
        = render 'shared/base_error', model: unit_role
        %section.section-block.user-permissions
          %h3 Select One or More User Permissions
          %section.card-section
            .ui-checkbox.medium
              = f.check_box :selection_authority, {id: 'selection-authority' + role_index.to_s}
              %label{:for => "selection-authority" + role_index.to_s} Selection Authority
            .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
              %div{"data-type" => "template-question-sample1b"}
                %p Include explanation about this section here.
          %section.card-section
            .ui-checkbox.medium
              = f.check_box :requisition_authority, {id: 'requisition-authority' + role_index.to_s}
              %label{:for => "requisition-authority" + role_index.to_s} Requisition Authority
            .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
              %div{"data-type" => "template-question-sample1b"}
                %p Include explanation about this section here.
          %section.card-section
            .ui-checkbox.medium
              = f.check_box :approval_authority, {id: 'approval-authority' + role_index.to_s}
              %label{:for => "approval-authority" + role_index.to_s} Approval Authority
            .button-circle.icon-question{"data-placement" => "bottom", "data-template" => "question-sample1b", "data-type" => "cm-popover"}
              %div{"data-type" => "template-question-sample1b"}
                %p Include explanation about this section here.
        = button_tag 'Update User Business Roles', type: 'submit', class: "button-cta button-primary icon-cr-arrow-right"
      .card-toggle


- content_for :footer do
  %footer#main-footer{:role => "contentinfo"}
    %p.site-credits &copy; 2015 Playground
  .ui-popover
  :javascript
    (function () {
        $(function () {
            var eventEmitter = $(document);

            eventEmitter.on('cm.toggle.close', function (event, data) {
                $('.entity-taxonomy').removeClass('is-open');
            });

            eventEmitter.on('cm.toggle.open', function (event, data) {
                if (data['toggle-head'] === undefined) {
                    $('.entity-taxonomy').addClass('is-open');
                }
            });
        });
    })();
